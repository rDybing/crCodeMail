/*********************************
 * Written in Go 1.9.1 linux/amd64
 * though any 1.x.x version should
 * work fine under any OS.
 *
 * CC-BY Roy Dybing 2017
 * github: rDybing
 * slack : rdybing
 **********************************/
package main

import (
	"bufio"
	"fmt"
	"os"
	"strconv"
	"strings"
)

func main() {
	var quit bool
	var message []string
	help()
	for quit == false {
		in, echo := getInput()
		switch in {
		case "":
			help()
		case "quit":
			quit = true
		default:
			key := keyGen(in)
			message = dataStringEncoded()
			if decrypt(key, message[0]) != "Greetings" {
				fmt.Printf("The force is weak in %s\n", echo)
			} else {
				fmt.Println()
				for i := range message {
					message[i] = decrypt(key, message[i])
					fmt.Println(message[i])
				}
			}
		}
	}
	os.Exit(0)
}

func help() {
	fmt.Println("-------------------")
	fmt.Println("--- Coder Radio ---")
	fmt.Println("-------------------")
	fmt.Println("- Type quit and then return to exit")
	fmt.Println("- Empty string will repeat this message")
	fmt.Println("- Anything else will be treated as the decoding key")
	fmt.Println("  (hint: It's Mike's all time favourite")
	fmt.Println("  Star Wars character - full name, no slacking!)")
}

func getInput() (string, string) {
	fmt.Print("-> ")
	input := bufio.NewReader(os.Stdin)
	line, _ := input.ReadString('\n')
	unformatted := line
	line = strings.ToLower(line)
	line = strings.Replace(line, " ", "", -1)
	line = strings.Replace(line, "\n", "", -1)
	return line, unformatted
}

func keyGen(in string) string {
	key := 2
	for i, r := range in {
		key *= int(r) ^ i
	}
	keyString := strconv.Itoa(key)
	return keyString
}

func decrypt(key string, in string) string {
	var out string
	keyLength := len(key) - 1
	keyCount := 0
	ts := strings.Split(in, ",")

	for i := 0; i < strings.Count(in, ","); i++ {
		if keyCount > keyLength {
			keyCount = 0
		}
		inTemp, _ := strconv.Atoi(ts[i])
		keyValue := int(key[keyCount])
		keyCount++
		out += string(inTemp - keyValue)
	}
	return out
}

func dataStringEncoded() []string {
	var data []string
	data = append(data, "116,166,153,156,168,156,166,152,165,")
	data = append(data, "115,166,163,164,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,81,82,171,168,")
	data = append(data, "123,163,166,174,149,172,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,138,166,85,90,91,100,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,101,96,152,92,85,86,85,90,125,93,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,103,157,81,164,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,88,87,92,85,86,85,90,101,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,151,92,85,148,163,86,87,86,84,87,82,83,82,80,80,77,84,147,177,88,87,92,85,86,85,90,125,150,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,119,85,86,147,100,150,86,84,87,82,83,82,80,80,77,84,146,118,88,87,92,85,86,85,90,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,101,86,85,90,149,86,84,87,82,83,95,149,149,144,98,84,87,146,145,130,129,144,81,100,101,155,153,156,86,88,96,94,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,87,84,83,88,94,92,91,132,87,89,151,87,82,83,95,142,90,87,94,98,156,121,83,88,143,172,85,134,91,90,88,91,86,87,86,84,84,159,97,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,94,170,146,88,88,91,88,87,157,166,113,85,155,172,86,91,91,86,87,86,146,80,81,113,146,97,88,87,88,95,86,85,90,91,90,88,91,86,87,86,142,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,95,96,96,142,111,81,88,88,91,88,87,92,85,86,148,148,91,90,151,87,96,145,144,142,80,146,88,127,87,84,112,150,143,92,112,90,91,90,132,149,144,145,144,")
	data = append(data, "77,84,84,172,153,152,157,95,82,145,112,151,86,84,91,119,83,83,81,152,77,115,88,91,88,87,92,85,86,85,152,87,136,88,133,89,177,83,81,80,87,88,88,125,84,125,150,143,144,116,100,87,86,148,")
	data = append(data, "77,84,126,87,84,147,150,85,86,150,171,151,87,156,87,83,84,83,144,100,78,85,112,118,88,87,92,85,86,85,90,135,86,115,149,96,152,151,149,93,167,98,153,156,146,83,182,85,86,150,100,153,168,")
	data = append(data, "77,84,91,161,88,87,134,150,146,112,90,91,153,148,107,83,177,146,93,149,90,110,85,113,148,87,92,85,86,85,90,91,86,88,91,92,93,144,170,80,81,146,134,91,132,83,88,100,82,143,90,91,90,150,129,")
	data = append(data, "77,84,84,107,88,87,92,119,144,95,150,118,90,88,154,146,84,83,80,134,138,98,85,88,85,147,119,85,86,85,90,125,100,88,91,86,86,82,84,165,81,89,84,156,153,93,150,143,82,107,106,151,148,88,149,113,87,163,")
	data = append(data, "77,84,84,87,146,145,152,93,83,82,87,113,150,88,91,128,97,102,81,81,171,178,98,181,178,103,88,112,86,85,124,94,90,88,125,96,115,96,90,80,90,128,98,156,116,87,92,85,86,150,153,101,86,84,87,82,83,82,142,")
	data = append(data, "77,84,84,87,146,133,170,145,83,82,87,88,158,84,118,86,87,149,144,152,103,84,148,90,84,84,89,81,86,119,98,169,106,88,131,92,93,92,80,80,146,88,88,91,88,87,92,85,86,85,90,91,90,156,154,")
	data = append(data, "77,84,84,87,84,83,91,150,89,101,87,88,87,85,131,146,87,86,146,87,78,98,110,88,156,147,182,175,82,95,90,125,93,146,87,82,83,82,148,84,81,88,88,91,88,87,92,85,86,85,90,91,90,88,91,86,155,94,")
	data = append(data, "77,84,84,87,84,83,88,143,86,95,150,88,87,85,88,154,83,86,84,146,141,85,98,87,97,83,88,81,82,85,134,87,101,91,87,82,83,96,84,84,81,88,88,91,88,87,92,85,86,85,90,91,90,88,91,86,87,86,84,147,")
	data = append(data, "77,84,84,87,84,83,88,81,82,143,90,154,150,85,88,83,155,146,84,84,91,104,178,87,84,83,88,81,82,85,90,91,168,91,87,82,83,110,84,84,81,88,88,91,88,87,92,85,86,85,90,91,90,88,91,86,87,130,142,142,139,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,149,170,153,101,146,177,82,84,84,143,84,84,87,84,83,88,81,82,145,124,172,155,97,87,82,83,146,84,84,81,88,88,91,88,87,92,85,86,85,90,91,134,146,101,108,83,82,81,81,77,146,112,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,149,144,112,102,84,128,139,84,84,87,84,83,102,93,94,93,100,87,99,146,101,82,83,82,111,84,81,88,88,91,88,87,92,85,86,143,117,113,100,84,88,83,83,108,81,81,171,84,96,99,153,150,102,95,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,91,98,174,91,88,87,92,85,86,85,90,91,158,96,87,82,83,82,144,84,81,88,88,91,88,131,150,95,96,145,87,157,86,110,88,152,83,176,89,124,167,153,88,91,88,131,150,143,144,143,117,160,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,165,148,81,88,88,91,88,87,92,85,86,85,90,91,90,88,159,82,83,82,80,144,108,88,88,125,84,111,89,82,89,109,87,117,112,178,96,167,152,86,84,128,87,146,98,101,110,84,89,82,83,82,86,129,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,97,125,84,84,81,88,88,91,88,87,92,85,86,85,90,91,90,88,91,94,83,82,80,80,77,132,98,117,153,90,89,151,82,82,180,87,155,152,91,86,131,144,94,106,78,85,85,88,85,84,89,82,146,95,154,149,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,172,87,86,84,84,81,88,88,91,88,87,92,85,86,85,90,91,90,88,91,86,83,82,80,80,77,84,104,88,85,177,142,150,86,85,90,135,150,110,88,83,84,83,81,81,78,85,85,88,91,97,157,129,89,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,100,92,145,96,80,94,77,146,115,118,88,87,92,85,86,85,90,91,90,88,91,86,83,82,80,80,77,84,84,181,84,147,178,85,86,85,124,149,100,148,88,83,84,83,81,81,78,85,85,88,91,95,156,129,144,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,100,146,87,91,109,83,81,152,77,157,148,88,97,83,96,143,113,85,90,91,90,88,91,152,83,82,80,80,77,84,84,87,96,87,92,129,144,107,87,87,95,98,87,146,90,83,81,81,78,148,96,155,88,121,95,")
	data = append(data, "77,84,84,87,84,83,88,95,167,150,155,156,171,98,129,146,96,144,94,81,149,84,112,100,84,83,182,145,96,95,86,118,117,88,91,89,83,82,80,80,77,84,84,99,88,87,88,107,83,82,150,156,90,88,91,86,152,82,144,92,146,88,122,94,")
	data = append(data, "77,84,84,87,153,87,92,85,86,85,90,91,90,88,91,86,87,86,149,149,150,119,84,149,93,114,114,94,110,107,91,94,112,146,118,82,83,82,80,80,77,84,84,118,88,153,88,82,83,82,86,118,90,88,91,86,145,94,118,142,")
	data = append(data, "77,84,84,135,146,97,102,95,96,145,150,151,148,146,118,86,87,86,84,84,81,88,88,91,153,168,132,143,96,82,100,101,150,84,101,82,83,82,80,80,77,84,84,87,146,135,173,95,145,95,98,151,150,146,149,")
	data = append(data, "77,84,84,91,84,84,89,82,83,82,87,88,87,85,88,108,109,96,142,142,108,115,88,91,88,87,92,85,151,123,180,149,115,98,87,82,83,82,80,80,77,84,84,87,84,83,152,145,146,145,")
	data = append(data, "77,84,84,118,88,97,152,82,83,82,87,88,87,85,88,83,84,83,81,81,78,110,98,149,115,114,92,85,86,85,90,154,93,98,")
	data = append(data, "77,84,84,87,146,114,154,95,146,82,87,88,87,85,88,83,84,83,81,81,78,85,85,88,85,113,102,143,113,85,90,91,90,151,")
	data = append(data, "77,84,84,87,84,83,150,112,86,148,150,94,87,85,88,83,84,83,81,81,78,85,85,94,96,152,157,147,94,81,148,91,90,88,162,")
	data = append(data, "77,84,84,87,84,83,88,81,82,143,117,91,155,98,151,89,84,83,81,81,78,85,85,87,88,87,92,85,86,81,113,101,117,88,91,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,148,115,91,151,152,94,144,144,84,91,85,101,146,114,92,129,146,154,87,88,86,103,135,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,145,144,111,111,81,150,153,154,96,95,102,93,149,150,155,156,134,146,")
	data = append(data, "77,84,84,87,84,83,88,81,82,81,86,87,86,84,87,82,83,82,80,80,77,84,84,151,146,145,150,143,144,143,")
	data = append(data, "77,")
	data = append(data, "122,153,166,169,173,83,123,153,164,154,169,171,163,149,170,82,148,160,148,80,154,149,173,87,126,148,166,166,147,163,175,87,103,167,171,82,149,151,80,163,162,166,170,160,170,148,154,157,151,81,159,157,86,164,152,155,161,152,165,156,77,110,93,")
	data = append(data, "77,")
	data = append(data, "110,162,173,159,163,170,88,94,82,122,86,174,151,167,87,147,167,82,145,80,160,161,149,163,160,83,170,150,153,154,165,165,151,160,87,121,148,159,149,163,90,119,163,165,154,152,170,150,160,148,155,87,151,84,154,161,168,162,156,149,77,163,154,87,161,162,166,165,154,164,86,152,157,163,99,82,")
	data = append(data, "164,157,168,159,84,148,88,151,151,168,86,159,171,162,155,164,152,150,80,145,161,168,153,165,152,152,157,164,96,81,131,166,169,168,87,165,152,151,157,149,145,84,149,174,154,168,164,157,171,81,175,166,171,162,158,94,83,147,158,148,77,161,149,165,173,83,175,150,164,150,86,170,170,157,163,158,83,")
	data = append(data, "150,162,84,154,163,159,164,150,153,150,86,170,170,169,155,171,156,160,151,80,147,163,166,87,167,162,165,150,82,163,165,163,155,84,166,164,83,161,164,152,146,166,84,160,162,83,172,153,151,81,157,152,163,153,170,82,149,167,163,153,155,153,167,170,98,83,121,159,150,81,127,87,")
	data = append(data, "144,163,169,163,152,83,166,160,166,81,158,156,162,164,87,155,161,82,157,169,77,163,160,155,84,153,153,163,166,81,153,176,164,157,154,147,159,82,157,153,155,152,84,171,163,83,172,153,155,159,161,87,170,156,152,166,83,166,152,149,160,153,84,152,160,159,88,146,164,150,86,164,165,167,171,82,")
	data = append(data, "153,157,159,156,160,172,88,164,166,166,154,176,159,162,158,82,167,154,149,157,160,153,160,173,153,166,88,154,160,165,165,87,151,84,161,161,149,82,145,164,77,129,151,123,163,161,153,157,150,164,100,101,100,84,128,160,151,151,149,148,89,84,133,172,157,167,157,81,147,81,156,156,173,84,")
	data = append(data, "161,156,153,169,153,83,164,160,161,156,155,155,86,160,160,157,152,82,160,165,160,156,157,165,155,83,107,97,82,146,164,155,86,167,171,155,159,158,80,156,150,170,157,165,155,83,160,160,159,150,86,174,159,168,159,82,160,161,157,157,166,84,152,156,149,165,157,164,166,95,")
	data = append(data, "77,")
	data = append(data, "121,157,159,156,84,167,160,150,155,163,86,164,155,152,160,147,95,82,150,153,153,161,96,87,149,165,172,81,147,159,154,87,163,169,170,155,150,82,163,164,162,152,153,165,168,166,88,147,151,151,165,169,155,84,171,154,152,159,94,")
	data = append(data, "77,")
	data = append(data, "115,166,157,158,156,167,158,166,158,157,175,87,156,153,174,82,162,152,80,164,149,153,84,166,162,152,171,81,123,81,170,152,162,159,156,150,83,166,159,80,149,149,152,87,149,161,177,81,162,163,165,158,168,149,164,159,156,160,151,80,146,172,164,156,166,156,157,159,149,150,98,87,163,163,170,166,83,")
	data = append(data, "160,168,169,155,157,152,156,81,89,120,151,164,155,84,123,151,166,155,151,158,84,84,149,165,152,83,156,146,148,147,162,156,154,84,160,160,83,135,158,153,161,173,98,87,125,83,163,159,161,168,98,87,170,156,156,82,154,147,157,149,77,157,162,155,169,166,172,163,171,81,163,160,157,156,171,82,")
	data = append(data, "160,153,153,164,84,159,161,156,151,81,151,87,156,169,165,82,163,158,145,147,146,84,168,166,84,149,157,93,82,147,171,171,86,157,171,82,156,165,80,145,153,166,153,152,152,172,88,150,170,165,168,156,163,153,163,171,83,149,159,157,157,153,168,160,168,156,174,150,82,146,164,155,86,170,156,164,172,82,")
	data = append(data, "147,153,171,99,84,167,160,150,82,165,165,167,86,168,156,160,83,162,149,162,144,153,162,171,84,163,157,163,154,146,166,170,98,84,174,155,159,158,80,152,142,170,153,87,149,161,177,81,154,160,166,156,86,163,157,82,148,160,169,80,160,169,151,154,153,166,171,81,95,81,151,170,86,")
	data = append(data, "154,153,149,170,169,165,157,149,82,147,175,87,152,153,160,160,154,82,145,146,153,153,84,171,163,83,164,154,168,150,86,152,86,151,166,159,153,161,162,164,142,150,160,156,84,160,161,149,150,157,155,154,162,149,170,165,83,158,153,150,146,167,168,176,160,152,88,160,152,151,86,166,156,84,")
	data = append(data, "154,149,159,160,162,154,88,152,147,158,155,170,100,")
	data = append(data, "77,")
	data = append(data, "118,91,161,87,149,167,88,165,154,150,86,166,170,156,156,164,83,165,153,148,146,84,163,157,84,167,153,147,158,150,86,152,169,84,160,166,83,169,149,162,146,84,97,87,160,162,167,156,155,159,157,87,170,163,87,154,156,164,149,80,142,84,102,123,84,148,171,164,151,165,169,87,153,166,156,147,167,161,162,80,")
	data = append(data, "90,84,149,165,152,83,159,160,161,149,86,105,122,84,152,160,151,82,99,116,77,149,166,171,157,166,172,164,82,146,168,156,86,149,87,150,156,159,149,80,142,84,152,166,174,152,166,95,82,120,151,164,155,84,155,151,166,155,151,158,146,166,167,87,149,165,157,81,169,153,151,171,86,125,94,150,83,")
	data = append(data, "157,169,168,87,167,162,164,154,150,157,175,87,159,162,171,161,83,166,152,149,77,91,125,155,153,148,171,81,121,166,175,170,93,84,154,147,167,151,151,159,159,173,98,87,139,155,161,148,154,81,159,170,86,168,166,82,166,147,169,80,143,173,84,152,162,151,88,157,147,163,157,156,86,")
	data = append(data, "162,167,153,163,153,166,171,95,82,133,158,156,86,164,169,161,154,164,145,157,154,153,166,170,84,124,95,158,82,159,165,171,86,168,166,161,83,169,159,162,159,157,153,155,84,148,154,160,167,165,86,100,86,163,165,149,152,82,164,152,146,84,167,166,160,156,156,81,150,154,155,171,86,163,157,82,")
	data = append(data, "159,153,152,100,150,168,164,157,94,81,164,166,165,152,163,151,166,82,145,158,145,84,161,160,151,165,167,168,147,167,155,87,166,157,177,172,148,82,163,164,142,166,168,87,168,162,88,157,161,164,155,87,159,168,94,165,83,147,160,160,146,149,160,99,84,167,160,150,171,81,151,171,86,160,156,147,166,166,80,")
	data = append(data, "164,157,160,163,84,149,157,81,147,147,162,156,86,168,166,82,154,151,164,80,142,84,164,169,163,163,157,163,82,155,165,153,100,")
	data = append(data, "77,")
	data = append(data, "119,169,167,171,84,159,161,156,151,81,155,173,155,166,176,82,158,155,148,80,90,84,149,171,84,159,157,146,165,165,86,174,158,153,165,82,124,82,167,145,160,84,173,166,169,161,159,81,95,81,173,152,164,168,156,150,83,166,159,80,143,153,84,156,157,167,160,150,164,81,151,87,")
	data = append(data, "115,157,155,159,168,152,170,81,130,154,162,166,170,84,166,164,83,132,159,147,152,97,135,171,149,165,100,81,166,153,155,170,155,84,155,147,172,165,80,153,161,84,167,156,153,160,171,81,158,154,161,156,86,157,171,82,156,165,80,164,149,153,84,158,149,160,157,81,155,159,154,172,169,168,169,171,83,")
	data = append(data, "161,156,149,171,84,155,153,167,151,81,153,152,171,155,159,166,83,166,152,149,150,166,84,155,153,166,161,163,151,164,100,")
	data = append(data, "77,")
	data = append(data, "110,162,173,87,168,155,167,166,153,153,170,170,86,163,165,82,167,154,149,80,160,169,150,161,153,150,172,112,82,136,155,94,168,153,87,166,162,158,148,80,142,155,149,160,162,83,153,159,150,81,151,158,151,157,165,82,167,154,145,164,77,168,156,156,166,152,88,154,165,81,151,165,86,149,154,167,167,151,80,")
	data = append(data, "153,149,151,162,84,162,158,81,123,133,86,167,168,163,157,151,166,165,153,159,155,149,160,170,96,83,168,163,161,152,168,152,163,161,156,164,166,82,153,158,77,164,149,169,168,156,155,166,158,146,168,101,86,125,171,82,166,151,149,157,160,84,165,172,157,167,157,81,166,153,155,87,173,149,170,166,152,82,")
	data = append(data, "161,163,84,154,156,148,166,159,151,157,86,171,158,153,87,157,156,150,163,80,150,162,168,166,84,154,153,158,151,94,155,165,157,157,165,151,96,149,159,158,147,157,155,172,166,148,172,154,161,159,100,101,100,")
	return data
}
